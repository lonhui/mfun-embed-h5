{"ast":null,"code":"import _classCallCheck from \"C:\\\\Users\\\\Administrator\\\\Desktop\\\\mfun-embed-h5\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"C:\\\\Users\\\\Administrator\\\\Desktop\\\\mfun-embed-h5\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/createClass\";\nimport _possibleConstructorReturn from \"C:\\\\Users\\\\Administrator\\\\Desktop\\\\mfun-embed-h5\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"C:\\\\Users\\\\Administrator\\\\Desktop\\\\mfun-embed-h5\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/getPrototypeOf\";\nimport _inherits from \"C:\\\\Users\\\\Administrator\\\\Desktop\\\\mfun-embed-h5\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/inherits\";\nimport _assertThisInitialized from \"C:\\\\Users\\\\Administrator\\\\Desktop\\\\mfun-embed-h5\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/assertThisInitialized\";\nvar _jsxFileName = \"C:\\\\Users\\\\Administrator\\\\Desktop\\\\mfun-embed-h5\\\\src\\\\pages\\\\GameList\\\\GameList.jsx\";\nimport React from 'react';\nimport { Row, Col } from 'antd';\nimport 'antd/dist/antd.css';\nimport './GameList.css';\nimport axios from 'axios';\nimport iScroll from 'iscroll/build/iscroll-probe';\nimport ReactIScroll from 'reactjs-iscroll';\nimport iconlv from '../../images/GameList/1@2x.png';\nimport right from '../../images/GameList/Right@32.png';\nvar list = [{\n  id: 1,\n  img: \"http://pic14.photophoto.cn/20100312/0005018312012169_b.jpg\",\n  name: 'Game Name',\n  desc: \"这是简介这是简介这是简介这是简介这是简，介这是简介这是简介，这是简介这是简介这是简介这是简介这是简介，这是简介这是简介。\",\n  lv: 1\n}, {\n  id: 2,\n  img: \"http://img.zcool.cn/community/01ca655600b1866ac7251df8918ba4.png\",\n  name: 'Game Name',\n  desc: \"这是简介这是简介这是简介这是简介这是简，介这是简介这是简介，这是简介这是简介这是简介这是简介这是简介，这是简介这是简介。\",\n  lv: 3\n}, {\n  id: 3,\n  img: \"http://pic51.nipic.com/file/20141031/8098773_204453536000_2.jpg\",\n  name: 'Game Name',\n  desc: \"这是简介这是简介这是简介这是简介这是简，介这是简介这是简介，这是简介这是简介这是简介这是简介这是简介，这是简介这是简介。\",\n  lv: 2\n}, {\n  id: 4,\n  img: \"http://pic.58pic.com/58pic/11/95/40/07S58PICXpC.jpg\",\n  name: 'Game Name',\n  desc: \"这是简介这是简介这是简介这是简介这是简，介这是简介这是简介，这是简介这是简介这是简介这是简介这是简介，这是简介这是简介。\",\n  lv: 5\n}, {\n  id: 5,\n  img: \"http://www.eise.org.cn/upload/img/8oSJh4ROwYGw3hfPpivZJJDiMcsRsOwF8iUqGHIAUwxCRJawempoMRSNJYXM7y77LKSUFVGVkclgTQcxmg.jpg\",\n  name: 'Game Name',\n  desc: \"这是简介这是简介这是简介这是简介这是简，介这是简介这是简介，这是简介这是简介这是简介这是简介这是简介，这是简介这是简介。\",\n  lv: 3\n}, {\n  id: 6,\n  img: \"http://pic26.photophoto.cn/20130110/0005018304499726_b.jpg\",\n  name: 'Game Name',\n  desc: \"这是简介这是简介这是简介这是简介这是简，介这是简介这是简介，这是简介这是简介这是简介这是简介这是简介，这是简介这是简介。\",\n  lv: 4\n}];\n\nvar GameList =\n/*#__PURE__*/\nfunction (_React$Component) {\n  _inherits(GameList, _React$Component);\n\n  function GameList(porps, context) {\n    var _this;\n\n    _classCallCheck(this, GameList);\n\n    _this = _possibleConstructorReturn(this, _getPrototypeOf(GameList).call(this, porps, context)); //设置当前页面title\n\n    document.getElementsByTagName(\"title\")[0].innerText = 'Game Center';\n    _this.state = {\n      items: [],\n      pullDownStatus: 3,\n      pullUpStatus: 0 // this.getGameList()\n\n    };\n    _this.page = 1;\n    _this.itemsChanged = false;\n    _this.pullDownTips = {\n      // 下拉状态\n      0: '下拉发起刷新',\n      1: '继续下拉刷新',\n      2: '松手即可刷新',\n      3: '正在刷新',\n      4: '刷新成功'\n    };\n    _this.pullUpTips = {\n      // 上拉状态\n      0: '上拉发起加载',\n      1: '松手即可加载',\n      2: '正在加载',\n      3: '加载成功'\n    };\n    _this.isTouching = false;\n    _this.onItemClicked = _this.onItemClicked.bind(_assertThisInitialized(_assertThisInitialized(_this)));\n    _this.onScroll = _this.onScroll.bind(_assertThisInitialized(_assertThisInitialized(_this)));\n    _this.onScrollEnd = _this.onScrollEnd.bind(_assertThisInitialized(_assertThisInitialized(_this)));\n    _this.onTouchStart = _this.onTouchStart.bind(_assertThisInitialized(_assertThisInitialized(_this)));\n    _this.onTouchEnd = _this.onTouchEnd.bind(_assertThisInitialized(_assertThisInitialized(_this)));\n    return _this;\n  }\n\n  _createClass(GameList, [{\n    key: \"componentDidMount\",\n    value: function componentDidMount() {\n      var options = {\n        // 默认iscroll会拦截元素的默认事件处理函数，我们需要响应onClick，因此要配置\n        preventDefault: false,\n        // 禁止缩放\n        zoom: false,\n        // 支持鼠标事件，因为我开发是PC鼠标模拟的\n        mouseWheel: true,\n        // 滚动事件的探测灵敏度，1-3，越高越灵敏，兼容性越好，性能越差\n        probeType: 3,\n        // 拖拽超过上下界后出现弹射动画效果，用于实现下拉/上拉刷新\n        bounce: true,\n        // 展示滚动条\n        scrollbars: true\n      };\n      this.iScrollInstance = new iScroll(\"#\".concat(style.ListOutsite), options);\n      this.iScrollInstance.on('scroll', this.onScroll);\n      this.iScrollInstance.on('scrollEnd', this.onScrollEnd);\n      this.fetchItems(true);\n    }\n  }, {\n    key: \"fetchItems\",\n    value: function fetchItems(isRefresh) {\n      var _this2 = this;\n\n      if (isRefresh) {\n        this.page = 1;\n      }\n\n      $.ajax({\n        url: '/msg-list',\n        data: {\n          page: this.page\n        },\n        type: 'GET',\n        dataType: 'json',\n        success: function success(response) {\n          if (isRefresh) {\n            // 刷新操作\n            if (_this2.state.pullDownStatus == 3) {\n              _this2.setState({\n                pullDownStatus: 4,\n                items: response.data.items\n              });\n\n              _this2.iScrollInstance.scrollTo(0, -1 * $(_this2.refs.PullDown).height(), 500);\n            }\n          } else {\n            // 加载操作\n            if (_this2.state.pullUpStatus == 2) {\n              _this2.setState({\n                pullUpStatus: 0,\n                items: _this2.state.items.concat(response.data.items)\n              });\n            }\n          }\n\n          ++_this2.page;\n          console.log(\"fetchItems=effected isRefresh=\".concat(isRefresh));\n        }\n      });\n    }\n  }, {\n    key: \"onTouchStart\",\n    value: function onTouchStart(ev) {\n      this.isTouching = true;\n    }\n  }, {\n    key: \"onTouchEnd\",\n    value: function onTouchEnd(ev) {\n      this.isTouching = false;\n    }\n  }, {\n    key: \"onPullDown\",\n    value: function onPullDown() {\n      // 手势\n      if (this.isTouching) {\n        if (this.iScrollInstance.y > 5) {\n          this.state.pullDownStatus != 2 && this.setState({\n            pullDownStatus: 2\n          });\n        } else {\n          this.state.pullDownStatus != 1 && this.setState({\n            pullDownStatus: 1\n          });\n        }\n      }\n    }\n  }, {\n    key: \"onPullUp\",\n    value: function onPullUp() {\n      // 手势\n      if (this.isTouching) {\n        if (this.iScrollInstance.y <= this.iScrollInstance.maxScrollY - 5) {\n          this.state.pullUpStatus != 1 && this.setState({\n            pullUpStatus: 1\n          });\n        } else {\n          this.state.pullUpStatus != 0 && this.setState({\n            pullUpStatus: 0\n          });\n        }\n      }\n    }\n  }, {\n    key: \"onScroll\",\n    value: function onScroll() {\n      var pullDown = $(this.refs.PullDown); // 上拉区域\n\n      if (this.iScrollInstance.y > -1 * pullDown.height()) {\n        this.onPullDown();\n      } else {\n        this.state.pullDownStatus != 0 && this.setState({\n          pullDownStatus: 0\n        });\n      } // 下拉区域\n\n\n      if (this.iScrollInstance.y <= this.iScrollInstance.maxScrollY + 5) {\n        this.onPullUp();\n      }\n    }\n  }, {\n    key: \"onScrollEnd\",\n    value: function onScrollEnd() {\n      console.log(\"onScrollEnd\" + this.state.pullDownStatus);\n      var pullDown = $(this.refs.PullDown); // 滑动结束后，停在刷新区域\n\n      if (this.iScrollInstance.y > -1 * pullDown.height()) {\n        if (this.state.pullDownStatus <= 1) {\n          // 没有发起刷新,那么弹回去\n          this.iScrollInstance.scrollTo(0, -1 * $(this.refs.PullDown).height(), 200);\n        } else if (this.state.pullDownStatus == 2) {\n          // 发起了刷新,那么更新状态\n          this.setState({\n            pullDownStatus: 3\n          });\n          this.fetchItems(true);\n        }\n      } // 滑动结束后，停在加载区域\n\n\n      if (this.iScrollInstance.y <= this.iScrollInstance.maxScrollY) {\n        if (this.state.pullUpStatus == 1) {\n          // 发起了加载，那么更新状态\n          this.setState({\n            pullUpStatus: 2\n          });\n          this.fetchItems(false);\n        }\n      }\n    }\n  }, {\n    key: \"shouldComponentUpdate\",\n    value: function shouldComponentUpdate(nextProps, nextState) {\n      // 列表发生了变化, 那么应该在componentDidUpdate时调用iscroll进行refresh\n      this.itemsChanged = nextState.items !== this.state.items;\n      return true;\n    }\n  }, {\n    key: \"componentDidUpdate\",\n    value: function componentDidUpdate() {\n      // 仅当列表发生了变更，才调用iscroll的refresh重新计算滚动条信息\n      if (this.itemsChanged) {\n        this.iScrollInstance.refresh();\n      }\n\n      return true;\n    }\n  }, {\n    key: \"getGameList\",\n    value: function getGameList() {\n      axios.get('/mfun/gameList').then(function (res) {\n        console.log(res);\n      });\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      return React.createElement(\"div\", {\n        id: \"GameLiet\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 248\n        },\n        __self: this\n      }, React.createElement(\"div\", {\n        className: \"head\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 249\n        },\n        __self: this\n      }, React.createElement(\"div\", {\n        className: \"new-game\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 250\n        },\n        __self: this\n      }, \"New Games\"), React.createElement(\"div\", {\n        className: \"more\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 251\n        },\n        __self: this\n      }, \"More\")), React.createElement(\"div\", {\n        className: \"list\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 253\n        },\n        __self: this\n      }, this.state.list.map(function (item) {\n        return React.createElement(Row, {\n          className: \"game-list\",\n          key: item.id,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 257\n          },\n          __self: this\n        }, React.createElement(Col, {\n          span: \"5\",\n          className: \"game-img\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 258\n          },\n          __self: this\n        }, React.createElement(\"img\", {\n          src: item.img,\n          alt: \"\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 260\n          },\n          __self: this\n        })), React.createElement(Col, {\n          span: \"14\",\n          className: \"game-text\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 263\n          },\n          __self: this\n        }, React.createElement(\"div\", {\n          className: \"game-name\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 264\n          },\n          __self: this\n        }, item.name), React.createElement(\"div\", {\n          className: \"game-lv\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 265\n          },\n          __self: this\n        }, item.lv >= 1 ? React.createElement(\"img\", {\n          src: iconlv,\n          alt: \"\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 266\n          },\n          __self: this\n        }) : '', item.lv >= 2 ? React.createElement(\"img\", {\n          src: iconlv,\n          alt: \"\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 267\n          },\n          __self: this\n        }) : '', item.lv >= 3 ? React.createElement(\"img\", {\n          src: iconlv,\n          alt: \"\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 268\n          },\n          __self: this\n        }) : '', item.lv >= 4 ? React.createElement(\"img\", {\n          src: iconlv,\n          alt: \"\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 269\n          },\n          __self: this\n        }) : '', item.lv >= 5 ? React.createElement(\"img\", {\n          src: iconlv,\n          alt: \"\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 270\n          },\n          __self: this\n        }) : ''), React.createElement(\"div\", {\n          className: \"introduction\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 272\n          },\n          __self: this\n        }, item.desc)), React.createElement(Col, {\n          span: \"3\",\n          className: \"more-ico\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 274\n          },\n          __self: this\n        }, React.createElement(\"img\", {\n          src: right,\n          alt: \"\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 275\n          },\n          __self: this\n        })));\n      })));\n    }\n  }]);\n\n  return GameList;\n}(React.Component);\n\nexport default GameList;","map":{"version":3,"sources":["C:\\Users\\Administrator\\Desktop\\mfun-embed-h5\\src\\pages\\GameList\\GameList.jsx"],"names":["React","Row","Col","axios","iScroll","ReactIScroll","iconlv","right","list","id","img","name","desc","lv","GameList","porps","context","document","getElementsByTagName","innerText","state","items","pullDownStatus","pullUpStatus","page","itemsChanged","pullDownTips","pullUpTips","isTouching","onItemClicked","bind","onScroll","onScrollEnd","onTouchStart","onTouchEnd","options","preventDefault","zoom","mouseWheel","probeType","bounce","scrollbars","iScrollInstance","style","ListOutsite","on","fetchItems","isRefresh","$","ajax","url","data","type","dataType","success","response","setState","scrollTo","refs","PullDown","height","concat","console","log","ev","y","maxScrollY","pullDown","onPullDown","onPullUp","nextProps","nextState","refresh","get","then","res","map","item","Component"],"mappings":"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","sourcesContent":["import React from 'react';\r\nimport { Row, Col } from 'antd';\r\nimport 'antd/dist/antd.css'\r\nimport './GameList.css';\r\nimport axios from 'axios';\r\nimport iScroll from 'iscroll/build/iscroll-probe';\r\nimport ReactIScroll from 'reactjs-iscroll';\r\nimport iconlv from '../../images/GameList/1@2x.png';\r\nimport right from '../../images/GameList/Right@32.png';\r\n\r\n\r\n\r\nvar list=[\r\n    {   \r\n        id:1,\r\n        img:\"http://pic14.photophoto.cn/20100312/0005018312012169_b.jpg\",\r\n        name:'Game Name',\r\n        desc:\"这是简介这是简介这是简介这是简介这是简，介这是简介这是简介，这是简介这是简介这是简介这是简介这是简介，这是简介这是简介。\",\r\n        lv:1,\r\n    },\r\n    {\r\n        id:2,\r\n        img:\"http://img.zcool.cn/community/01ca655600b1866ac7251df8918ba4.png\",\r\n        name:'Game Name',\r\n        desc:\"这是简介这是简介这是简介这是简介这是简，介这是简介这是简介，这是简介这是简介这是简介这是简介这是简介，这是简介这是简介。\",\r\n        lv:3,\r\n    },\r\n    {\r\n        id:3,\r\n        img:\"http://pic51.nipic.com/file/20141031/8098773_204453536000_2.jpg\",\r\n        name:'Game Name',\r\n        desc:\"这是简介这是简介这是简介这是简介这是简，介这是简介这是简介，这是简介这是简介这是简介这是简介这是简介，这是简介这是简介。\",\r\n        lv:2,\r\n    },\r\n    {\r\n        id:4,\r\n        img:\"http://pic.58pic.com/58pic/11/95/40/07S58PICXpC.jpg\",\r\n        name:'Game Name',\r\n        desc:\"这是简介这是简介这是简介这是简介这是简，介这是简介这是简介，这是简介这是简介这是简介这是简介这是简介，这是简介这是简介。\",\r\n        lv:5,\r\n    },\r\n    {\r\n        id:5,\r\n        img:\"http://www.eise.org.cn/upload/img/8oSJh4ROwYGw3hfPpivZJJDiMcsRsOwF8iUqGHIAUwxCRJawempoMRSNJYXM7y77LKSUFVGVkclgTQcxmg.jpg\",\r\n        name:'Game Name',\r\n        desc:\"这是简介这是简介这是简介这是简介这是简，介这是简介这是简介，这是简介这是简介这是简介这是简介这是简介，这是简介这是简介。\",\r\n        lv:3,\r\n    },\r\n    {\r\n        id:6,\r\n        img:\"http://pic26.photophoto.cn/20130110/0005018304499726_b.jpg\",\r\n        name:'Game Name',\r\n        desc:\"这是简介这是简介这是简介这是简介这是简，介这是简介这是简介，这是简介这是简介这是简介这是简介这是简介，这是简介这是简介。\",\r\n        lv:4,\r\n    }\r\n]\r\n\r\nclass GameList extends React.Component{\r\n    constructor(porps,context){\r\n        super(porps,context);\r\n        //设置当前页面title\r\n        document.getElementsByTagName(\"title\")[0].innerText = 'Game Center';\r\n        this.state={\r\n            items: [],\r\n            pullDownStatus: 3,\r\n            pullUpStatus: 0,\r\n        }\r\n        // this.getGameList()\r\n        this.page = 1;\r\n        this.itemsChanged = false;\r\n \r\n        this.pullDownTips = {\r\n            // 下拉状态\r\n            0: '下拉发起刷新',\r\n            1: '继续下拉刷新',\r\n            2: '松手即可刷新',\r\n            3: '正在刷新',\r\n            4: '刷新成功',\r\n        };\r\n \r\n        this.pullUpTips = {\r\n            // 上拉状态\r\n            0: '上拉发起加载',\r\n            1: '松手即可加载',\r\n            2: '正在加载',\r\n            3: '加载成功',\r\n        };\r\n \r\n        this.isTouching = false;\r\n \r\n        this.onItemClicked = this.onItemClicked.bind(this);\r\n \r\n        this.onScroll = this.onScroll.bind(this);\r\n        this.onScrollEnd = this.onScrollEnd.bind(this);\r\n \r\n        this.onTouchStart = this.onTouchStart.bind(this);\r\n        this.onTouchEnd = this.onTouchEnd.bind(this);\r\n    }\r\n\r\n    componentDidMount() {\r\n        const options = {\r\n            // 默认iscroll会拦截元素的默认事件处理函数，我们需要响应onClick，因此要配置\r\n            preventDefault: false,\r\n            // 禁止缩放\r\n            zoom: false,\r\n            // 支持鼠标事件，因为我开发是PC鼠标模拟的\r\n            mouseWheel: true,\r\n            // 滚动事件的探测灵敏度，1-3，越高越灵敏，兼容性越好，性能越差\r\n            probeType: 3,\r\n            // 拖拽超过上下界后出现弹射动画效果，用于实现下拉/上拉刷新\r\n            bounce: true,\r\n            // 展示滚动条\r\n            scrollbars: true,\r\n        };\r\n        this.iScrollInstance = new iScroll(`#${style.ListOutsite}`, options);\r\n        this.iScrollInstance.on('scroll', this.onScroll);\r\n        this.iScrollInstance.on('scrollEnd', this.onScrollEnd);\r\n \r\n        this.fetchItems(true);\r\n    }\r\n\r\n    fetchItems(isRefresh) {\r\n        if (isRefresh) {\r\n            this.page = 1;\r\n        }\r\n        $.ajax({\r\n            url: '/msg-list',\r\n            data: {page: this.page},\r\n            type: 'GET',\r\n            dataType: 'json',\r\n            success: (response) => {\r\n                if (isRefresh) {    // 刷新操作\r\n                    if (this.state.pullDownStatus == 3) {\r\n                        this.setState({\r\n                            pullDownStatus: 4,\r\n                            items: response.data.items\r\n                        });\r\n                        this.iScrollInstance.scrollTo(0, -1 * $(this.refs.PullDown).height(), 500);\r\n                    }\r\n                } else {    // 加载操作\r\n                    if (this.state.pullUpStatus == 2) {\r\n                        this.setState({\r\n                            pullUpStatus: 0,\r\n                            items: this.state.items.concat(response.data.items)\r\n                        });\r\n                    }\r\n                }\r\n                ++this.page;\r\n                console.log(`fetchItems=effected isRefresh=${isRefresh}`);\r\n            }\r\n        });\r\n    }\r\n\r\n    onTouchStart(ev) {\r\n        this.isTouching = true;\r\n    }\r\n \r\n    onTouchEnd(ev) {\r\n        this.isTouching = false;\r\n    }\r\n\r\n    onPullDown() {\r\n        // 手势\r\n        if (this.isTouching) {\r\n            if (this.iScrollInstance.y > 5) {\r\n                this.state.pullDownStatus != 2 && this.setState({pullDownStatus: 2});\r\n            } else {\r\n                this.state.pullDownStatus != 1 && this.setState({pullDownStatus: 1});\r\n            }\r\n        }\r\n    }\r\n \r\n    onPullUp() {\r\n        // 手势\r\n        if (this.isTouching) {\r\n            if (this.iScrollInstance.y <= this.iScrollInstance.maxScrollY - 5) {\r\n                this.state.pullUpStatus != 1 && this.setState({pullUpStatus: 1});\r\n            } else {\r\n                this.state.pullUpStatus != 0 && this.setState({pullUpStatus: 0});\r\n            }\r\n        }\r\n    }\r\n\r\n    onScroll() {\r\n        let pullDown = $(this.refs.PullDown);\r\n \r\n        // 上拉区域\r\n        if (this.iScrollInstance.y > -1 * pullDown.height()) {\r\n            this.onPullDown();\r\n        } else {\r\n            this.state.pullDownStatus != 0 && this.setState({pullDownStatus: 0});\r\n        }\r\n \r\n        // 下拉区域\r\n        if (this.iScrollInstance.y <= this.iScrollInstance.maxScrollY + 5) {\r\n            this.onPullUp();\r\n        }\r\n    }\r\n\r\n    onScrollEnd() {\r\n        console.log(\"onScrollEnd\" + this.state.pullDownStatus);\r\n \r\n        let pullDown = $(this.refs.PullDown);\r\n \r\n        // 滑动结束后，停在刷新区域\r\n        if (this.iScrollInstance.y > -1 * pullDown.height()) {\r\n            if (this.state.pullDownStatus <= 1) {   // 没有发起刷新,那么弹回去\r\n                this.iScrollInstance.scrollTo(0, -1 * $(this.refs.PullDown).height(), 200);\r\n            } else if (this.state.pullDownStatus == 2) { // 发起了刷新,那么更新状态\r\n                this.setState({pullDownStatus: 3});\r\n                this.fetchItems(true);\r\n            }\r\n        }\r\n \r\n        // 滑动结束后，停在加载区域\r\n        if (this.iScrollInstance.y <= this.iScrollInstance.maxScrollY) {\r\n            if (this.state.pullUpStatus == 1) { // 发起了加载，那么更新状态\r\n                this.setState({pullUpStatus: 2});\r\n                this.fetchItems(false);\r\n            }\r\n        }\r\n    }\r\n\r\n    shouldComponentUpdate(nextProps, nextState) {\r\n        // 列表发生了变化, 那么应该在componentDidUpdate时调用iscroll进行refresh\r\n        this.itemsChanged = nextState.items !== this.state.items;\r\n        return true;\r\n    }\r\n \r\n    componentDidUpdate() {\r\n        // 仅当列表发生了变更，才调用iscroll的refresh重新计算滚动条信息\r\n        if (this.itemsChanged) {\r\n            this.iScrollInstance.refresh();\r\n        }\r\n        return true;\r\n    }\r\n\r\n    getGameList(){\r\n        axios.get('/mfun/gameList').then((res)=>{\r\n            console.log(res)\r\n        })\r\n    }\r\n\r\n    \r\n\r\n    render(){\r\n        return(\r\n            <div id=\"GameLiet\">\r\n                <div className=\"head\">\r\n                    <div className=\"new-game\">New Games</div>\r\n                    <div className=\"more\">More</div>\r\n                </div>\r\n                <div className=\"list\">\r\n                    {\r\n                        this.state.list.map(function(item){\r\n                            return (\r\n                                <Row  className=\"game-list\" key={item.id}>\r\n                                    <Col span=\"5\" className=\"game-img\">\r\n                                        {/* <a href=\"https://www.jianshu.com/p/d1ef832e8e65\"> */}\r\n                                            <img src={item.img} alt=\"\"/>\r\n                                        {/* </a> */}\r\n                                    </Col>\r\n                                    <Col span=\"14\" className=\"game-text\">\r\n                                        <div className=\"game-name\">{item.name}</div>\r\n                                        <div className=\"game-lv\">\r\n                                            {item.lv>=1?<img src={iconlv} alt=\"\"/>:''}\r\n                                            {item.lv>=2?<img src={iconlv} alt=\"\"/>:''}\r\n                                            {item.lv>=3?<img src={iconlv} alt=\"\"/>:''}\r\n                                            {item.lv>=4?<img src={iconlv} alt=\"\"/>:''}\r\n                                            {item.lv>=5?<img src={iconlv} alt=\"\"/>:''}\r\n                                        </div>\r\n                                        <div className=\"introduction\">{item.desc}</div>\r\n                                    </Col>\r\n                                    <Col  span=\"3\" className=\"more-ico\">\r\n                                        <img src={right} alt=\"\"/>\r\n                                    </Col>\r\n                                </Row>\r\n                            )\r\n                        })\r\n                    }\r\n                    \r\n                </div>\r\n            </div>\r\n        )\r\n    }\r\n}\r\n\r\nexport default GameList;"]},"metadata":{},"sourceType":"module"}